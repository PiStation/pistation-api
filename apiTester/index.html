<!doctype html>
<html>
<head>
    <title>PiStation WebSocket API tester</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font: 13px Helvetica, Arial; }
        form { background: #000; padding: 3px; position: fixed; bottom: 0; width: 100%; }
        form input { border: 0; padding: 10px; width: 90%; margin-right: .5%; }
        form button { width: 9%; background: rgb(130, 224, 255); border: none; padding: 10px; }
    </style>
    <script src="https://code.jquery.com/jquery-1.11.3.js"></script>
</head>
<body>
<ul id="messages"></ul>

Event: <input type="text" autocomplete="eventName" id="event"/><br/>
Data (JSON):
<textarea id="data">{}socket</textarea><br/>
<button id="send">Send</button>
<br/><br/>
Default:<br/>
<button id="getAllModules">getAllModules</button>

<script src="http://localhost:31415/socket.io/socket.io.js"></script>
<script>
    var socket = io('http://localhost:31415');

    //Implement a catch all
    var onevent = socket.onevent;
    socket.onevent = function (packet) {
        var args = packet.data || [];
        onevent.call (this, packet);    // original call
        packet.data = ["*"].concat(args);
        onevent.call(this, packet);      // additional call to catch-all
    };

    //Hook in to the catch all
    socket.on("*",function(event,data) {
        console.log('Received event: ' + event);
        console.log('Received event data:', data);
    });

    $('#send').on('click', function() {
        console.log('Clicked');
        socket.emit($('#event').val(), JSON.parse($('#data').val()));
    });

    $('#getAllModules').on('click', function() {
        socket.emit('getAllModules');
    });
</script>
</body>
</html>